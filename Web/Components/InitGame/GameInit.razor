@using SC2APIProtocol
@using Web.Services
@inject SC2Client SC2Client
@implements IDisposable

@if (SC2Client.CurrentStatus == Status.Launched || SC2Client.CurrentStatus == Status.Ended || SC2Client.CurrentStatus ==
Status.Unknown || SC2Client.CurrentStatus == Status.InitGame)
{
  <div class="bg-gray-800/50 text-white shadow rounded-lg">
    <div class="border-b border-gray-700">
      <nav class="-mb-px flex" aria-label="Tabs">
        <a href="#" class="@(activeTab == "create" ? "border-blue-500 text-blue-400" : "border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-600") w-1/2 py-4 px-1 text-center border-b-2 font-medium text-sm no-underline" @onclick='() => activeTab = "create"' @onclick:preventDefault>
          Create Game
        </a>
        <a href="#" class="@(activeTab == "join" ? "border-blue-500 text-blue-400" : "border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-600") w-1/2 py-4 px-1 text-center border-b-2 font-medium text-sm no-underline" @onclick='() => activeTab = "join"' @onclick:preventDefault>
          Join Multiplayer
        </a>
      </nav>
    </div>
    <div class="p-4">
      @if (activeTab == "create")
      {
        <CreateGame  />
      }
      else
      {
        <JoinMultiplayerGame  />
      }
    </div>
  </div>
}

@code {
  private string activeTab = "create";

  protected override void OnInitialized()
  {
    SC2Client.OnGameStateChanged += Refresh;
  }

  private void Refresh() => InvokeAsync(StateHasChanged);


  public void Dispose()
  {
    SC2Client.OnGameStateChanged -= Refresh;
  }
}